/*
 * File:   acquisition.h
 * Author: GIBIC UdeA
 *
 * Created on July 4, 2020, 13:41 PM
 */

#ifndef ACQUISITION_H
#define ACQUISITION_H

#ifdef __cplusplus
extern "C"
{
#endif

   // #include <stdio.h>
   // #include <stdlib.h>
   // #include <string.h>

   /** ****************************************************************************
 ** ************ INCLUDES ******************************************************
 ** ****************************************************************************/
#include <Arduino.h>
#include <Esp.h>
#include <nvs_flash.h>

#include "initializer.h"
#include "timer.h"
#include "cyclingFunctions.h"

   /** ****************************************************************************
 ** ************ DEFINES *******************************************************
 ** ****************************************************************************/
#define L_F_PROM 40 // numero de datos en el filtro moving average de la señal de visualizacion de flujo

#define DERIVATE_UP_THRESHOLD 0.2  // umbral para definir el valor maximo en estabilidad
#define DERIVATE_DO_THRESHOLD -0.2 // umbral para definir el valor minimo en estabilidad
#define DERIVATE_LO_THRESHOLD -0.3 // nivel para deteccion de cambio rapido

   /** ****************************************************************************
 ** ************ VARIABLES *****************************************************
 ** ****************************************************************************/

   /** ****************************************************************************
 ** ************ FUNCTIONS *****************************************************
 ** ****************************************************************************/
   /************************************************************
 ***** FUNCIONES DE ATENCION A INTERRUPCION TAREA ADC *******
 ************************************************************/
   void task_Adc(void *arg);
   /************************************************************
 ***** ENVÍO DE TRAMA DE DATOS HACIA LA RASPBERRY ***********
 ************************************************************/
   void task_Raspberry(void *arg);

   /* *****************************************************************************
 * *****************************************************************************
 * ******************** USO DE MODULO ADS **************************************
 * *****************************************************************************
 * *****************************************************************************/

   /* *****************************************************************************
 * *****************************************************************************
 * ***************** PROTOTYPE DEFINITION **************************************
 * *****************************************************************************
 * *****************************************************************************/

#ifdef __cplusplus
}
#endif

#endif /* ACQUISITION_H */
